using System;
using System.Threading.Tasks;
using Microsoft.Extensions.Options;
using NAuth.Client;
using NAuth.DTO.Domain;
using NAuth.DTO.Settings;
using NAuth.DTO.User;

namespace NAuth.ConsoleExample
{
    class Program
    {
        static async Task Main(string[] args)
        {
            // Configure NAuth settings
            var nauthSettings = Options.Create(new NAuthSetting
            {
                ApiUrl = "https://your-api-endpoint.com" // Replace with your API endpoint
            });

            // Create UserClient instance
            var userClient = new UserClient(nauthSettings);

            // Prepare login parameters
            var loginParams = new LoginParam
            {
                Email = "user@example.com",
                Password = "password123",
                RememberMe = true
            };

            try
            {
                // Call LoginWithEmailAsync method
                var result = await userClient.LoginWithEmailAsync(loginParams);

                // Check login result
                if (result != null && result.Success)
                {
                    Console.WriteLine($"Login successful! User: {result.User.Name}, Token: {result.Token}");
                }
                else
                {
                    Console.WriteLine("Login failed: " + result?.Message);
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine("Error while logging in: " + ex.Message);
            }
        }
    }
}
